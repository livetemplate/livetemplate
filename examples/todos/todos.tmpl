<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - LiveTemplate with Pico CSS</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
</head>
<body>
    <main class="container">
        <article>
            <header>
                <h1>{{.Title}}</h1>
                <p>A simple todo app with real-time updates</p>
            </header>

            <!-- Add Todo Form -->
            <form lvt-change="validate" lvt-submit="add" lvt-debounce="300">
                <fieldset role="group">
                    <input
                        type="text"
                        name="text"
                        placeholder="What needs to be done?"
                        required
                        {{if .lvt.HasError "text"}}aria-invalid="true"{{end}}
                    >
                    <button type="submit" lvt-disable-with="Adding...">Add</button>
                </fieldset>
                {{if .lvt.HasError "text"}}
                <small style="color: var(--pico-del-color);">{{.lvt.Error "text"}}</small>
                {{end}}
            </form>

            <!-- Statistics -->
            <p>
                <small>
                    Total: <strong>{{.TotalCount}}</strong> •
                    Completed: <strong>{{.CompletedCount}}</strong> •
                    Remaining: <strong>{{.RemainingCount}}</strong>
                </small>
            </p>

            <!-- Search -->
            <form lvt-change="search" lvt-debounce="300">
                <input
                    type="search"
                    name="query"
                    placeholder="Search todos..."
                    value="{{.SearchQuery}}"
                >
            </form>

            <!-- Todo List -->
            <section>
                <header><strong>Tasks</strong></header>
                <table>
                    <tbody>
                        {{range .FilteredTodos}}
                        <tr data-key="{{.ID}}">
                            <td>
                                <input
                                    type="checkbox"
                                    {{if .Completed}}checked{{end}}
                                    lvt-change="toggle"
                                    lvt-data-id="{{.ID}}"
                                >
                            </td>
                            <td style="{{if .Completed}}text-decoration: line-through; opacity: 0.6;{{end}}">
                                {{.Text}}
                            </td>
                            <td>
                                <button
                                    lvt-click="delete"
                                    lvt-data-id="{{.ID}}"
                                    class="secondary"
                                >
                                    Delete
                                </button>
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
                {{if eq (len .FilteredTodos) 0}}
                <p>
                    {{if ne .SearchQuery ""}}
                    <small>No todos found matching "{{.SearchQuery}}"</small>
                    {{end}}
                    {{if eq .SearchQuery ""}}
                    <small>No todos yet. Add one above!</small>
                    {{end}}
                </p>
                {{end}}

                {{if gt .CompletedCount 0}}
                <button lvt-click="clear_completed" class="secondary">
                    Clear Completed ({{.CompletedCount}})
                </button>
                {{end}}
            </section>

            <footer>
                <small>Last updated: {{.LastUpdated}}</small>
            </footer>
        </article>
    </main>

    <script src="livetemplate-client.js"></script>
</body>
</html>
